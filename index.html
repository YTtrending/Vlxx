<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VLXX VIDEOS</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .video-card { transition: transform 0.2s; width: 100%; }
        .video-card:hover { transform: scale(1.02); }
        .pagination-btn { 
            padding: 10px 20px; 
            margin: 0 4px; 
            font-size: 1rem; 
            border-radius: 8px; 
            touch-action: manipulation; 
        }
        .pagination-btn.active { background-color: #2563eb; color: white; }
        .pagination-btn:disabled { background-color: #e5e7eb; cursor: not-allowed; }
        .page-input { width: 60px; padding: 8px; border: 1px solid #d1d5db; border-radius: 8px; }
        .thumbnail { width: 100%; max-width: 100%; height: auto; display: block; }
        .thumbnail-container { width: 100%; padding: 0; }
        .filter-box { max-width: 100%; }
        .video-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.25rem; }
        .description { display: inline; }
        .read-more { display: inline; margin-left: 0.25rem; white-space: nowrap; }
        .description-container { display: block; }
        @media (max-width: 640px) {
            .video-card { flex-direction: column; padding: 0.125rem; }
            .video-card .ml-4 { margin-left: 0; margin-top: 0.125rem; }
            .text-xl { font-size: 0.625rem; line-height: 1.1; }
            .text-sm { font-size: 0.75rem; line-height: 1.1; }
            .text-xs { font-size: 0.625rem; line-height: 1.1; }
            .read-more { line-height: 1.1; }
            .pagination-btn { padding: 6px 12px; font-size: 0.75rem; }
            .page-input { width: 40px; padding: 4px; }
            .video-grid { gap: 0.25rem; }
            .description-container, .text-xs { margin-top: 0.125rem; }
        }
        @media (min-width: 641px) and (max-width: 1024px) {
            .video-card { flex-direction: column; padding: 0.5rem; }
            .video-card .ml-4 { margin-left: 0; margin-top: 0.25rem; }
            .text-xl { font-size: 1rem; line-height: 1.1; }
            .text-sm { font-size: 1rem; line-height: 1.1; }
            .text-xs { font-size: 0.875rem; line-height: 1.1; }
            .read-more { line-height: 1.1; }
            .pagination-btn { padding: 10px 20px; font-size: 1rem; }
            .page-input { width: 60px; padding: 8px; }
            .video-grid { grid-template-columns: repeat(4, 1fr); gap: 1rem; }
            .description-container, .text-xs { margin-top: 0.25rem; }
        }
        @media (min-width: 1025px) {
            .video-card { flex-direction: column; padding: 0.75rem; }
            .video-card .ml-4 { margin-left: 0; margin-top: 0.25rem; }
            .text-xl { font-size: 1.125rem; line-height: 1.1; }
            .text-sm { font-size: 1.125rem; line-height: 1.1; }
            .text-xs { font-size: 1rem; line-height: 1.1; }
            .read-more { line-height: 1.1; }
            .pagination-btn { padding: 12px 24px; font-size: 1.125rem; }
            .page-input { width: 70px; padding: 10px; }
            .video-grid { grid-template-columns: repeat(5, 1fr); gap: 1.5rem; }
            .description-container, .text-xs { margin-top: 0.25rem; }
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto">
        <h1 class="text-2xl font-bold mb-4 text-center sm:text-3xl">VLXX VIDEOS</h1>
        <div class="mb-4 flex justify-center">
            <select id="sort-select" class="filter-box p-2 border rounded-lg bg-white text-sm sm:text-base">
                <option value="id">Sort by Time (Newest)</option>
                <option value="views">Sort by Views</option>
                <option value="likes">Sort by Likes</option>
                <option value="rating">Sort by Rating</option>
            </select>
        </div>
        <div id="top-pagination" class="flex justify-center mb-6 space-x-2 flex-wrap"></div>
        <div id="video-list" class="video-grid"></div>
        <div id="bottom-pagination" class="flex justify-center mt-6 space-x-2 flex-wrap"></div>
    </div>

    <script>
        async function loadVideos() {
            let data;
            try {
                // Try fetching JSON data from data.txt
                const response = await fetch('data.txt');
                if (!response.ok) throw new Error('Failed to load data.txt');
                data = await response.json();
            } catch (error) {
                console.warn('Error loading data.txt, using fallback data:', error);
                // Fallback to simplified sample data
                data = [
                    {
                        "id": 2962,
                        "title": "Trốn trong tủ nhìn vợ mình \"cưỡi ngựa\" cùng cấp dưới",
                        "link": "https://vlxx.bz/video/tron-trong-tu-nhin-vo-minh-cuoi-ngua-cung-cap-duoi/2962/",
                        "thumbnail": "https://vlxx.bz/img2/2962.jpg",
                        "description": "Tôi và Eimi quen nhau qua một người quen và tiến tới hôn nhân chỉ sau sáu tháng. Lúc mới cưới, bố mẹ của cả hai đều phản đối, nên Eimi và tôi quyết định sẽ có con sau khi tôi được thăng chức. Kinjo là hậu bối của tôi ở công ty, là người vô trách nhiệm, thường xuyên gây chuyện khiến tôi phải vất vả đi xử lý hậu quả. Hôm nay cậu ta làm bẩn quần áo, nhà tôi ở gần đó nên tôi đưa cậu ta về nhà tôi thay đồ. Cũng từ lần đó, Eimi bắt đầu cư xử kỳ lạ, dường như cô ấy đang dần xa cách tôi hơn. Hơn nữa, tô...",
                        "views": 646200
                    },
                    {
                        "id": 2961,
                        "title": "Chị dâu, em chỉ đút cặc vào lồn chị... 3cm thôi",
                        "link": "https://vlxx.bz/video/chi-dau-em-chi-dut-cac-vao-lon-chi-3cm-thoi/2961/",
                        "thumbnail": "https://vlxx.bz/img2/2961.jpg",
                        "description": "Anh trai và chị dâu Eimi của Yuji chuẩn bị về sống chung với cả nhà. Chị dâu Eimi vừa tốt bụng, lại vô cùng xinh đẹp khiến Yuji đã phải lòng cô ngay từ lần đầu gặp mặt. Khi không thể kìm nén cảm xúc của bản thân được nữa, Yuji đã mạnh dạn thổ lộ với Eimi nhưng bị từ chối. Không bỏ cuộc, Yuji liên tục thổ lộ với Eimi, cầu xin cô cho cậu hôn một lần thôi, Eimi miễn cưỡng đồng ý. Nhưng từ hôn, Yuji bắt đầu đòi hỏi nhiều hơn, đến bú cặc, đến đút cặc vào trong lồn của cô 3 cm thôi! Nhưng dù chỉ đút v...",
                        "views": 1400000
                    }
                ];
            }

            const videosPerPage = 30;
            let currentPage = 1;
            let sortBy = 'id';

            // Sorting function
            function sortVideos() {
                data.sort((a, b) => {
                    if (sortBy === 'id') return parseInt(b.id) - parseInt(a.id);
                    if (sortBy === 'views') return parseFloat(b.views) - parseFloat(a.views);
                    if (sortBy === 'likes') return parseFloat(b.likes || 0) - parseFloat(a.likes || 0);
                    if (sortBy === 'rating') return parseFloat(b.rating || 0) - parseFloat(a.rating || 0);
                    return 0;
                });
            }

            // Initial sort
            sortVideos();

            // Handle sort change
            document.getElementById('sort-select').addEventListener('change', (e) => {
                sortBy = e.target.value;
                currentPage = 1; // Reset to page 1 on sort change
                sortVideos();
                displayVideos(currentPage);
            });

            function displayVideos(page) {
                const start = (page - 1) * videosPerPage;
                const end = start + videosPerPage;
                const paginatedVideos = data.slice(start, end);

                const videoList = document.getElementById('video-list');
                videoList.innerHTML = '';

                paginatedVideos.forEach(video => {
                    const videoCard = document.createElement('div');
                    videoCard.className = 'video-card bg-white rounded-lg shadow-md flex';
                    videoCard.innerHTML = `
                        <div class="thumbnail-container">
                            <a href="${video.link}" target="_blank" class="flex-shrink-0 w-full">
                                <img src="${video.thumbnail}" alt="${video.title}" class="thumbnail object-cover rounded-t">
                            </a>
                        </div>
                        <div class="ml-4 flex-1">
                            <a href="${video.link}" target="_blank" class="text-lg font-bold text-red-600 hover:underline sm:text-xl">${video.title}</a>
                            <div class="description-container">
                                <p class="text-gray-600 text-sm description" data-full="${video.description}">${video.description.substring(0, 50)}...</p>
                                <button class="read-more text-blue-500 text-sm hover:underline">Xem thêm</button>
                            </div>
                            <p class="text-xs text-gray-500 sm:text-sm">Views: ${formatViews(video.views)}</p>
                            <p class="text-xs text-gray-500 sm:text-sm">${video.categories ? 'Categories: ' + video.categories : ''}</p>
                        </div>
                    `;
                    videoList.appendChild(videoCard);
                });

                // Add event listeners for "Xem thêm"/"Ẩn đi" buttons
                document.querySelectorAll('.read-more').forEach(button => {
                    button.addEventListener('click', () => {
                        const description = button.previousElementSibling;
                        const fullText = description.dataset.full;
                        if (button.textContent === 'Xem thêm') {
                            description.textContent = fullText;
                            description.style.display = 'block'; // Full description wraps normally
                            button.textContent = 'Ẩn đi';
                        } else {
                            description.textContent = fullText.substring(0, 50) + '...';
                            description.style.display = 'inline'; // Truncated description inline with button
                            button.textContent = 'Xem thêm';
                        }
                    });
                });

                updatePagination();
                // Scroll to top of page
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            function formatViews(views) {
                if (typeof views === 'string') views = parseFloat(views.replace(/[^0-9.]/g, '')) * (views.includes('M') ? 1000000 : views.includes('K') ? 1000 : 1);
                if (views >= 1000000) return (views / 1000000).toFixed(1) + 'M';
                if (views >= 1000) return (views / 1000).toFixed(1) + 'K';
                return views.toLocaleString();
            }

            function updatePagination() {
                const totalPages = Math.ceil(data.length / videosPerPage);
                const paginationContainers = ['top-pagination', 'bottom-pagination'];

                paginationContainers.forEach(containerId => {
                    const pagination = document.getElementById(containerId);
                    pagination.innerHTML = '';

                    // Previous button
                    const prevBtn = document.createElement('button');
                    prevBtn.className = 'pagination-btn bg-gray-200 rounded';
                    prevBtn.textContent = 'Previous';
                    prevBtn.disabled = currentPage === 1;
                    prevBtn.addEventListener('click', () => {
                        if (currentPage > 1) {
                            currentPage--;
                            displayVideos(currentPage);
                        }
                    });
                    pagination.appendChild(prevBtn);

                    // Page numbers: show ±3 pages and +5, +10, +20, +50, +100
                    const pageNumbers = new Set();
                    // Add ±3 pages around current page
                    for (let i = Math.max(1, currentPage - 3); i <= Math.min(totalPages, currentPage + 3); i++) {
                        pageNumbers.add(i);
                    }
                    // Add specific offsets: +5, +10, +20, +50, +100
                    const offsets = [5, 10, 20, 50, 100];
                    offsets.forEach(offset => {
                        if (currentPage + offset <= totalPages) {
                            pageNumbers.add(currentPage + offset);
                        }
                    });
                    // Always include page 1 and last page
                    pageNumbers.add(1);
                    pageNumbers.add(totalPages);

                    // Sort and display page numbers
                    Array.from(pageNumbers).sort((a, b) => a - b).forEach(i => {
                        const pageBtn = document.createElement('button');
                        pageBtn.className = `pagination-btn bg-gray-200 rounded ${i === currentPage ? 'active' : ''}`;
                        pageBtn.textContent = i;
                        pageBtn.addEventListener('click', () => {
                            currentPage = i;
                            displayVideos(currentPage);
                        });
                        pagination.appendChild(pageBtn);
                    });

                    // Next button
                    const nextBtn = document.createElement('button');
                    nextBtn.className = 'pagination-btn bg-gray-200 rounded';
                    nextBtn.textContent = 'Next';
                    nextBtn.disabled = currentPage === totalPages;
                    nextBtn.addEventListener('click', () => {
                        if (currentPage < totalPages) {
                            currentPage++;
                            displayVideos(currentPage);
                        }
                    });
                    pagination.appendChild(nextBtn);

                    // Page input
                    const pageInput = document.createElement('input');
                    pageInput.type = 'number';
                    pageInput.min = 1;
                    pageInput.max = totalPages;
                    pageInput.value = currentPage;
                    pageInput.className = 'page-input';
                    pageInput.addEventListener('change', () => {
                        let newPage = parseInt(pageInput.value);
                        if (newPage >= 1 && newPage <= totalPages) {
                            currentPage = newPage;
                            displayVideos(currentPage);
                        } else {
                            pageInput.value = currentPage;
                        }
                    });
                    pagination.appendChild(pageInput);
                });
            }

            displayVideos(currentPage);
        }

        // Load videos on page load
        window.onload = loadVideos;
    </script>
</body>
</html>
